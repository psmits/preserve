\documentclass[12pt,letterpaper]{article}

\usepackage{amsmath, amsthm, amsfonts, amssymb}
\usepackage{graphicx,hyperref}
\usepackage{microtype, parskip}
\usepackage[comma,sort&compress]{natbib}
\usepackage{docmute}

\frenchspacing

\begin{document}
\section{Methods}

\subsection{Fossil occurrence information}
Foote and Miller data.

\subsection{Hierarchical counting model}

\subsubsection{Likelihood}
First, define \(y_{i}\) as some count of fossil occurrences of genus \(j\) in a geologic stage for \(i = 1, \dots, n\) and \(j = 1, \dots, J\).

The Poisson distribution is commonly used to model count data such as the number of observed fossils. The Poisson distribution has one parameter \(\lambda\) which is a rate or inverse-scale parameter. \(\lambda\) can be interpreted as the expected count observed \(\mathbf{E}[y]\). \(\lambda\) can be reparameterized as a regression using the log link function \(\mathbf{E}[y] = exp(\alpha)\) where \(\alpha\) can be any real number. This is written formally as
\begin{align}
  y_{i} &\sim \mathrm{Poisson}(\lambda_{i}) \nonumber\\
  \lambda_{i} &= \exp(\alpha_{i}).
  \label{eq:poisson} 
\end{align}

Currently, this model (Eq. \ref{eq:poisson}) does not take into account the generic membership \(j\) of the fossil count and assumes that all genera have the same sighting rate. To account for variation in occurrence rate between genera while also modeling mean generic occurrence rate I take a Bayesian hierarchical modeling approach \citep{Gelman2007}. First, I redefine \(\alpha_{i}\) as \(\alpha_{j[i]}\) to indicate that observation \(i\) is a member of genus \(j\). I then assume that genera can be considered exchangeable or that the actual value of \(j\) has no meaning. Given this assumption, values of \(\alpha_{j[i]}\) are given the same, shared prior written as
\begin{equation}
  \alpha_{j[i]} \sim \mathcal{N}(0, \sigma_{j}).
  \label{eq:alpha_step1}
\end{equation}
The scale hyperparameter of the shared prior (Eq. \ref{eq:alpha_step1}) is itself estimated from the data itself. This approach allows genera with small sample size to pull towards the mean of the prior while still genera with large sample sizes and strong effects to be modeled.

This hierarchical approach can be further extended to allow for genus ordinal membership. Define \(k\) as the order that genus \(j\) belongs to, where \(k = 1, \dots, K\). Then, instead of assuming the mean of the prior on \(\alpha\) is 0 (Eq. \ref{eq:alpha_step1}), and instead have the mean of the prior be \(\mu_{k[j]}\) which is the estimate of the rate of fossil occurrence for order \(k\). Then, assuming that orders are exchangeable, values of \(\mu_{k[j]}\) are given the same, shared prior. These changes are then written as
\begin{align}
  \alpha_{j[i]} &\sim \mathcal{N}(\mu_{k[j]}, \sigma_{j}) \nonumber \\
  \mu_{k[j]} &\sim \mathcal{N}(0, \sigma_{k}).
  \label{eq:alpha_step2}
\end{align}

The current model (Eq. \ref{eq:poisson}) does not take into account the number of chances to count an observation. For example, if counting the number of traffic accidents at a street corner it matters if 20 vehicles have passed through the intersection versus 100. To account for this we can define an exposure term \(u_{i}\) for each observation. In this study, \(u_{i}\) is defined as the number of localities species \(i\) occurred in during the given stage. The inclusion of \(u_{i}\) is formulated as 
\begin{align}
  y_{i} &= \mathrm{Poisson}(u_{i}\lambda_{i}) \nonumber\\
  \lambda_{i} &= \exp(\log(u_{i}) + \alpha_{j[i]}).
  \label{eq:poisson_exposure}
\end{align}
The inclusion of \(\log(u_{i}\) in the parameterization of \(\lambda_{i}\) (Eq. \ref{eq:poisson_exposure}) is due to the following relationships 
\begin{align*}
  \frac{\mathbf{E}[y_i]}{u_{i}} &= \lambda_{i} \\
  \mathbf{E}[y_{i}] &= u_{i}\lambda_{i} \\
  \log(\mathbf{E}[y_{i}]) &= \log(u_{i}) + \log(\lambda_{i}) \\
\end{align*}
We can now interpret \(\lambda\) as the expected number of co-occurring species per locality for a given observation. While \(u_{i}\) is called the exposure, \(\log(u_{i})\) is called the offset \citep{Gelman2007}. 

One of the major assumptions of the Poisson distribution is that, because there is only one parameter, the variance of the distribution is equal to the mean (\(\frac{Var[y]}{E[y]}\)). When variance is greater than the mean, this is called overdispersion. We can relax this assumption by assuming that, instead of a Poisson distribution, observations are drawn from a negative bionmial distribution \citep{Gelman2007}. Here, I use the following parameterization of the negative binomial 
\begin{equation}
  \mathrm{Negative\ binomial}(y | \eta, \phi) = {y + \phi -1 \choose y} \left(\frac{\eta}{\eta + \phi}\right)^{y} \left(\frac{\phi}{\eta + \phi}\right)^{\phi}
  \label{eq:neg_bin}
\end{equation}
where \(\eta\) is the mean and \(\phi\) is the overdispersion. Substituting the negative binomial for the Poisson, the aspects model current defined are written
\begin{align}
  y_{i} &= \mathrm{Negative\ binomial}(u_{i}\eta_{i}, \phi_{y}) \nonumber \\
  \eta_{i} &= \exp(\alpha_{j[i]}) \nonumber \\
  \alpha_{j[i]} &\sim \mathrm{Normal}(\mu_{k[j]}, \sigma_{j}) \nonumber \\
  \mu_{k[j]} &\sim \mathrm{Normal}(0, \sigma_{k}).
  \label{eq:nb_mod}
\end{align}

Finally, given the Bayesian framework taken here, there is the assignment of priors to various non-hierarchically modeled parameters. Scale parameters were given weakly informative half-Cauchy (C\(^{+}\)) priors because they have good regulatory priors for constraining hierarchical effects \citep{Gelman2006,Gelman2013b}. The priors used here are
\begin{align*}
  \phi_{y} &\sim \mathrm{C^{+}}(2.5) \\
  \sigma_{j} &\sim \mathrm{C^{+}}(2.5) \\
  \sigma_{k} &\sim \mathrm{C^{+}}(2.5).
\end{align*}
The Cauchy distribution is equivalent to the \textit{t}-distribution with 1 degree of freedom, and the half-Cauchy distribution is the Cauchy folded about 0.


\end{document}
